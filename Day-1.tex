% Options for packages loaded elsewhere
% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
  letterpaper,
  DIV=11,
  numbers=noendperiod]{scrartcl}
\usepackage{xcolor}
\usepackage{amsmath,amssymb}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
% Make \paragraph and \subparagraph free-standing
\makeatletter
\ifx\paragraph\undefined\else
  \let\oldparagraph\paragraph
  \renewcommand{\paragraph}{
    \@ifstar
      \xxxParagraphStar
      \xxxParagraphNoStar
  }
  \newcommand{\xxxParagraphStar}[1]{\oldparagraph*{#1}\mbox{}}
  \newcommand{\xxxParagraphNoStar}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
  \let\oldsubparagraph\subparagraph
  \renewcommand{\subparagraph}{
    \@ifstar
      \xxxSubParagraphStar
      \xxxSubParagraphNoStar
  }
  \newcommand{\xxxSubParagraphStar}[1]{\oldsubparagraph*{#1}\mbox{}}
  \newcommand{\xxxSubParagraphNoStar}[1]{\oldsubparagraph{#1}\mbox{}}
\fi
\makeatother

\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{241,243,245}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.40,0.45,0.13}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\BuiltInTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\ExtensionTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.28,0.35,0.67}{#1}}
\newcommand{\ImportTok}[1]{\textcolor[rgb]{0.00,0.46,0.62}{#1}}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.07,0.07,0.07}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}

\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\newsavebox\pandoc@box
\newcommand*\pandocbounded[1]{% scales image to fit in text height/width
  \sbox\pandoc@box{#1}%
  \Gscale@div\@tempa{\textheight}{\dimexpr\ht\pandoc@box+\dp\pandoc@box\relax}%
  \Gscale@div\@tempb{\linewidth}{\wd\pandoc@box}%
  \ifdim\@tempb\p@<\@tempa\p@\let\@tempa\@tempb\fi% select the smaller of both
  \ifdim\@tempa\p@<\p@\scalebox{\@tempa}{\usebox\pandoc@box}%
  \else\usebox{\pandoc@box}%
  \fi%
}
% Set default figure placement to htbp
\def\fps@figure{htbp}
\makeatother





\setlength{\emergencystretch}{3em} % prevent overfull lines

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}



 


\usepackage{booktabs}
\usepackage{longtable}
\usepackage{array}
\usepackage{multirow}
\usepackage{wrapfig}
\usepackage{float}
\usepackage{colortbl}
\usepackage{pdflscape}
\usepackage{tabu}
\usepackage{threeparttable}
\usepackage{threeparttablex}
\usepackage[normalem]{ulem}
\usepackage{makecell}
\usepackage{xcolor}
\KOMAoption{captions}{tableheading}
\makeatletter
\@ifpackageloaded{tcolorbox}{}{\usepackage[skins,breakable]{tcolorbox}}
\@ifpackageloaded{fontawesome5}{}{\usepackage{fontawesome5}}
\definecolor{quarto-callout-color}{HTML}{909090}
\definecolor{quarto-callout-note-color}{HTML}{0758E5}
\definecolor{quarto-callout-important-color}{HTML}{CC1914}
\definecolor{quarto-callout-warning-color}{HTML}{EB9113}
\definecolor{quarto-callout-tip-color}{HTML}{00A047}
\definecolor{quarto-callout-caution-color}{HTML}{FC5300}
\definecolor{quarto-callout-color-frame}{HTML}{acacac}
\definecolor{quarto-callout-note-color-frame}{HTML}{4582ec}
\definecolor{quarto-callout-important-color-frame}{HTML}{d9534f}
\definecolor{quarto-callout-warning-color-frame}{HTML}{f0ad4e}
\definecolor{quarto-callout-tip-color-frame}{HTML}{02b875}
\definecolor{quarto-callout-caution-color-frame}{HTML}{fd7e14}
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{Table of contents}
\else
  \newcommand\contentsname{Table of contents}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{List of Figures}
\else
  \newcommand\listfigurename{List of Figures}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{List of Tables}
\else
  \newcommand\listtablename{List of Tables}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{Figure}
\else
  \newcommand\figurename{Figure}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{Table}
\else
  \newcommand\tablename{Table}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{Listing}
\newcommand*\listoflistings{\listof{codelisting}{List of Listings}}
\makeatother
\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother
\usepackage{bookmark}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={Ngày 1 - Phân tích số liệu sử dụng R},
  pdfauthor={Ba Khuong Cao},
  colorlinks=true,
  linkcolor={blue},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={Blue},
  pdfcreator={LaTeX via pandoc}}


\title{Ngày 1 - Phân tích số liệu sử dụng R}
\author{Ba Khuong Cao}
\date{}
\begin{document}
\maketitle


\begin{tcolorbox}[enhanced jigsaw, titlerule=0mm, breakable, opacitybacktitle=0.6, coltitle=black, colframe=quarto-callout-important-color-frame, left=2mm, colback=white, arc=.35mm, bottomtitle=1mm, opacityback=0, leftrule=.75mm, toprule=.15mm, bottomrule=.15mm, title=\textcolor{quarto-callout-important-color}{\faExclamation}\hspace{0.5em}{Ưu điểm}, rightrule=.15mm, toptitle=1mm, colbacktitle=quarto-callout-important-color!10!white]

\begin{itemize}
\item
  Không cần phải phân tích cho từng biến số và đánh tay kết quả vào bảng
  trình bày kết quả nghiên cứu.
\item
  Có thể xuất kết quả ra file word và copy/paste trực tiếp. Việc này
  giúp hạn chế sai sót trong quá trình phân tích do không cần phải đánh
  tay kết quả vào bảng.
\end{itemize}

\end{tcolorbox}

\begin{tcolorbox}[enhanced jigsaw, titlerule=0mm, breakable, opacitybacktitle=0.6, coltitle=black, colframe=quarto-callout-note-color-frame, left=2mm, colback=white, arc=.35mm, bottomtitle=1mm, opacityback=0, leftrule=.75mm, toprule=.15mm, bottomrule=.15mm, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Mô tả dataset}, rightrule=.15mm, toptitle=1mm, colbacktitle=quarto-callout-note-color!10!white]

Trong phần phân tích ngày hôm nay, chúng ta sẽ sử dụng bộ số liệu được
public trên tạp chí. Bài báo khoa học này nói về việc nhiễm HIV ở phụ nữ
hoạt động mại dâm.

Link:
https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0197251

Phần phân tích này sử dụng dataset có tên
\texttt{data\_file\_Table\_1.csv}. Phần mô tả cụ thể của dataset này như
sau (Theo công bố trong bài báo):

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\linewidth - 4\tabcolsep) * \real{0.2269}}
  >{\raggedright\arraybackslash}p{(\linewidth - 4\tabcolsep) * \real{0.4958}}
  >{\raggedright\arraybackslash}p{(\linewidth - 4\tabcolsep) * \real{0.2689}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
Variable name (Tên biến)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Variable description (Mô tả)
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Codes (Mã hóa)
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
unique & Subject identification number & Numeric \\
q103 & Nationality & 1 = Benin

2 = Ghana

3 = Nigeria

4 = Togo

5 = Others \\
age & Age in years & Numeric \\
age\_3cat & Age in years (categories) & 1 = 18--24

2 = 25--34

3 = ≥ 35 \\
q105 & Education & 0 = Not educated

1 = Primary

2 = Secondary

3 = Postsecondary, university \\
q114 & Marital status & 1 = Married

2 = Single

3 = Divorced

4 = Widowed \\
q107 & Place of work & 1 = Brothel

2 = Home

3 = Bars

4 = Hotels

5 = Street

6 = Nightclub

7 = Others \\
duree & Duration in sex work (months) & Numeric \\
q205 & Number of clients (last 7 days of work) & Numeric \\
q219 & Number of sexual intercourses (last 3 days) & Numeric \\
constante & Consistent condom use with clients (last 7 days of work) & 1
= Yes

2 = No \\
q211 & Condom use with last client & 1 = Yes

2 = No \\
groupe & HIV/treatment status & 1 = HIV positive, treated

2 = HIV positive, not treated

3 = HIV negative \\
anal & Ever had anal sex (any partner) & 1 = No

2 = Yes \\
hla9 & Ever had oral sex (any partner) & 1 = Yes

2 = No \\
gono & NG prevalence & 1 = Positive

2 = Negative

9 = No answer \\
chlam & CT prevalence & 1 = Positive

2 = Negative

9 = No answer \\
gonochlam & NG/CT prevalence & 1 = Positive

2 = Negative

9 = No answer \\
cd4\_nb & CD4 cell count/mm³ & Numeric \\
charge\_virale\_copies & Viral load & Numeric \\
\end{longtable}

\end{tcolorbox}

\begin{tcolorbox}[enhanced jigsaw, titlerule=0mm, breakable, opacitybacktitle=0.6, coltitle=black, colframe=quarto-callout-important-color-frame, left=2mm, colback=white, arc=.35mm, bottomtitle=1mm, opacityback=0, leftrule=.75mm, toprule=.15mm, bottomrule=.15mm, title=\textcolor{quarto-callout-important-color}{\faExclamation}\hspace{0.5em}{Các bước thực hiện}, rightrule=.15mm, toptitle=1mm, colbacktitle=quarto-callout-important-color!10!white]

\begin{itemize}
\tightlist
\item
  Loading packages: Cài đặt một số gói (packages) phân tích cần thiết
\item
  Loading dataset
\item
  Thực hiện một số bước cần thiết để mã hóa dữ liệu
\item
  Phân tích kết quả
\end{itemize}

\end{tcolorbox}

\section{1. Loading packages}\label{loading-packages}

Chúng ta sẽ sử dụng một vài packages: \texttt{gmodels}, \texttt{dplyr},
\texttt{psych}, \texttt{gtsummary}, \texttt{readxl}, \texttt{readr},
\texttt{finalfit}, \texttt{flextable}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Check whether pacman is available and install if needed}
\FunctionTok{options}\NormalTok{(}\AttributeTok{repos =} \FunctionTok{c}\NormalTok{(}\AttributeTok{CRAN =} \StringTok{"https://cloud.r{-}project.org"}\NormalTok{))}
\ControlFlowTok{if}\NormalTok{ (}\SpecialCharTok{!}\FunctionTok{requireNamespace}\NormalTok{(}\StringTok{"pacman"}\NormalTok{, }\AttributeTok{quietly =} \ConstantTok{TRUE}\NormalTok{)) }\FunctionTok{install.packages}\NormalTok{(}\StringTok{"pacman"}\NormalTok{)}

\CommentTok{\# Use pacman to install (if needed) and load the required packages}
\NormalTok{pacman}\SpecialCharTok{::}\FunctionTok{p\_load}\NormalTok{(gmodels, dplyr, psych, gtsummary, readxl,readr,finalfit,flextable)}
\end{Highlighting}
\end{Shaded}

\section{2. Loading dataset}\label{loading-dataset}

Các datasets liên quan đến bài báo này có thể tải xuống theo link:

https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0197251

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Define a base folder path}
\NormalTok{data\_folder }\OtherTok{\textless{}{-}} \StringTok{"Papers attached with data/HIV incidence among female sex workers"}

\CommentTok{\# Read CSV }
\NormalTok{hiv\_tab\_1\_data }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\FunctionTok{file.path}\NormalTok{(data\_folder, }\StringTok{"data\_file\_Table\_1.csv"}\NormalTok{))}

\CommentTok{\# Inspect the structure of the dataset}
\FunctionTok{str}\NormalTok{(hiv\_tab\_1\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
spc_tbl_ [319 x 20] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ unique              : chr [1:319] "D001T" "D002T" "D003T" "D004T" ...
 $ q103                : num [1:319] 2 1 4 2 4 2 2 3 1 4 ...
 $ age                 : num [1:319] 47 51 42 44 49 45 51 25 44 44 ...
 $ age_3cat            : num [1:319] 3 3 3 3 3 3 3 2 3 3 ...
 $ q105                : num [1:319] 1 1 0 1 0 1 0 1 0 1 ...
 $ q114                : num [1:319] 3 3 2 4 3 2 2 2 2 2 ...
 $ q107                : num [1:319] 5 5 1 1 5 1 1 1 2 1 ...
 $ duree               : num [1:319] 48 180 60 36 24 60 180 72 48 120 ...
 $ q205                : num [1:319] 19 32 72 35 54 11 27 13 1 19 ...
 $ q219                : num [1:319] 12 14 38 14 28 9 13 9 0 13 ...
 $ constante           : num [1:319] 1 2 1 1 1 2 1 1 1 1 ...
 $ q211                : num [1:319] 1 1 1 1 1 1 1 1 1 1 ...
 $ groupe              : num [1:319] 1 1 1 1 1 1 1 1 1 1 ...
 $ anal                : num [1:319] 1 1 1 1 1 1 1 1 1 1 ...
 $ hla9                : num [1:319] 2 2 2 2 2 2 2 2 2 2 ...
 $ gono                : num [1:319] 1 2 2 1 2 2 2 2 2 2 ...
 $ chlam               : num [1:319] 2 2 2 2 2 2 2 2 2 2 ...
 $ gonochlam           : num [1:319] 1 2 2 1 2 2 2 2 2 2 ...
 $ cd4_nb              : num [1:319] 219 297 191 464 525 145 263 710 734 280 ...
 $ charge_virale_copies: num [1:319] 50 50 1683 848 50 ...
 - attr(*, "spec")=
  .. cols(
  ..   unique = col_character(),
  ..   q103 = col_double(),
  ..   age = col_double(),
  ..   age_3cat = col_double(),
  ..   q105 = col_double(),
  ..   q114 = col_double(),
  ..   q107 = col_double(),
  ..   duree = col_double(),
  ..   q205 = col_double(),
  ..   q219 = col_double(),
  ..   constante = col_double(),
  ..   q211 = col_double(),
  ..   groupe = col_double(),
  ..   anal = col_double(),
  ..   hla9 = col_double(),
  ..   gono = col_double(),
  ..   chlam = col_double(),
  ..   gonochlam = col_double(),
  ..   cd4_nb = col_double(),
  ..   charge_virale_copies = col_double()
  .. )
 - attr(*, "problems")=<externalptr> 
\end{verbatim}

\begin{tcolorbox}[enhanced jigsaw, titlerule=0mm, breakable, opacitybacktitle=0.6, coltitle=black, colframe=quarto-callout-note-color-frame, left=2mm, colback=white, arc=.35mm, bottomtitle=1mm, opacityback=0, leftrule=.75mm, toprule=.15mm, bottomrule=.15mm, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Notes}, rightrule=.15mm, toptitle=1mm, colbacktitle=quarto-callout-note-color!10!white]

Hầu hết tất cả các biến trong dataset này đều là dạng
\texttt{num}(\texttt{numeric}), trừ biến \texttt{unique}. Như vậy để phù
hợp với dạng dữ liệu được mô tả theo bảng ở trên, một số biến sẽ cần
biến đổi thành \texttt{factor}(Biến phân loại/nhị phân)

\end{tcolorbox}

\subsection{\texorpdfstring{Chuyển một số biến sang dạng
\texttt{factor}}{Chuyển một số biến sang dạng factor}}\label{chuyux1ec3n-mux1ed9t-sux1ed1-biux1ebfn-sang-dux1ea1ng-factor}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Convert to factors {-}{-}{-}{-}}
\NormalTok{factor\_vars }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}
  \StringTok{"q103"}\NormalTok{, }\StringTok{"age\_3cat"}\NormalTok{, }\StringTok{"q105"}\NormalTok{, }\StringTok{"q114"}\NormalTok{, }\StringTok{"q107"}\NormalTok{,}
  \StringTok{"constante"}\NormalTok{, }\StringTok{"q211"}\NormalTok{, }\StringTok{"groupe"}\NormalTok{, }\StringTok{"anal"}\NormalTok{, }\StringTok{"hla9"}\NormalTok{,}
  \StringTok{"gono"}\NormalTok{, }\StringTok{"chlam"}\NormalTok{, }\StringTok{"gonochlam"}\NormalTok{)}

\NormalTok{hiv\_tab\_1\_data[factor\_vars] }\OtherTok{\textless{}{-}} \FunctionTok{lapply}\NormalTok{(hiv\_tab\_1\_data[factor\_vars], as.factor)}
\end{Highlighting}
\end{Shaded}

\subsection{Gán nhãn giá trị}\label{guxe1n-nhuxe3n-giuxe1-trux1ecb}

Các nhãn giá trị của các biến có thể được gán (theo bảng mô tả các biến
ở trên)

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Labeling for values of variables {-}{-}{-}{-}}
\FunctionTok{levels}\NormalTok{(hiv\_tab\_1\_data}\SpecialCharTok{$}\NormalTok{q103)}\OtherTok{=}\FunctionTok{c}\NormalTok{(}\StringTok{"Benin"}\NormalTok{,}\StringTok{"Ghana"}\NormalTok{,}\StringTok{"Nigeria"}\NormalTok{, }\StringTok{"Togo"}\NormalTok{, }\StringTok{"Others"}\NormalTok{)}
\FunctionTok{levels}\NormalTok{(hiv\_tab\_1\_data}\SpecialCharTok{$}\NormalTok{age\_3cat)}\OtherTok{=}\FunctionTok{c}\NormalTok{(}\StringTok{"18 {-} 24"}\NormalTok{,}\StringTok{"25 {-} 34"}\NormalTok{,}\StringTok{"\textgreater{}=35"}\NormalTok{)}
\FunctionTok{levels}\NormalTok{(hiv\_tab\_1\_data}\SpecialCharTok{$}\NormalTok{q105)}\OtherTok{=}\FunctionTok{c}\NormalTok{(}\StringTok{"Not educated"}\NormalTok{,}\StringTok{"Primary"}\NormalTok{,}\StringTok{"Secondary"}\NormalTok{,}
                              \StringTok{"Postsecondary, university"}\NormalTok{)}
\FunctionTok{levels}\NormalTok{(hiv\_tab\_1\_data}\SpecialCharTok{$}\NormalTok{q114)}\OtherTok{=}\FunctionTok{c}\NormalTok{(}\StringTok{"Married"}\NormalTok{,}\StringTok{"Single"}\NormalTok{,}\StringTok{"Divorced"}\NormalTok{, }\StringTok{"Widowed"}\NormalTok{)}
\FunctionTok{levels}\NormalTok{(hiv\_tab\_1\_data}\SpecialCharTok{$}\NormalTok{q107)}\OtherTok{=}\FunctionTok{c}\NormalTok{(}\StringTok{"Brothel"}\NormalTok{,}\StringTok{"Home"}\NormalTok{,}\StringTok{"Bars"}\NormalTok{, }\StringTok{"Hotels"}\NormalTok{,}\StringTok{"Street"}\NormalTok{,}
                              \StringTok{"Nightclub"}\NormalTok{,}\StringTok{"Others"}\NormalTok{)}
\FunctionTok{levels}\NormalTok{(hiv\_tab\_1\_data}\SpecialCharTok{$}\NormalTok{constante)}\OtherTok{=}\FunctionTok{c}\NormalTok{(}\StringTok{"Yes"}\NormalTok{,}\StringTok{"No"}\NormalTok{)}
\FunctionTok{levels}\NormalTok{(hiv\_tab\_1\_data}\SpecialCharTok{$}\NormalTok{q211)}\OtherTok{=}\FunctionTok{c}\NormalTok{(}\StringTok{"Yes"}\NormalTok{,}\StringTok{"No"}\NormalTok{)}
\FunctionTok{levels}\NormalTok{(hiv\_tab\_1\_data}\SpecialCharTok{$}\NormalTok{groupe)}\OtherTok{=}\FunctionTok{c}\NormalTok{(}\StringTok{"HIV positive, treated"}\NormalTok{,}
                                \StringTok{"HIV positive, not treated"}\NormalTok{, }\StringTok{"HIV negative"}\NormalTok{)}
\FunctionTok{levels}\NormalTok{(hiv\_tab\_1\_data}\SpecialCharTok{$}\NormalTok{anal)}\OtherTok{=}\FunctionTok{c}\NormalTok{(}\StringTok{"No"}\NormalTok{,}\StringTok{"Yes"}\NormalTok{)}
\FunctionTok{levels}\NormalTok{(hiv\_tab\_1\_data}\SpecialCharTok{$}\NormalTok{hla9)}\OtherTok{=}\FunctionTok{c}\NormalTok{(}\StringTok{"Yes"}\NormalTok{,}\StringTok{"No"}\NormalTok{)}
\FunctionTok{levels}\NormalTok{(hiv\_tab\_1\_data}\SpecialCharTok{$}\NormalTok{gono)}\OtherTok{=}\FunctionTok{c}\NormalTok{(}\StringTok{"Positive"}\NormalTok{,}\StringTok{"Negative"}\NormalTok{, }\StringTok{"No answer"}\NormalTok{)}
\FunctionTok{levels}\NormalTok{(hiv\_tab\_1\_data}\SpecialCharTok{$}\NormalTok{chlam)}\OtherTok{=}\FunctionTok{c}\NormalTok{(}\StringTok{"Positive"}\NormalTok{,}\StringTok{"Negative"}\NormalTok{, }\StringTok{"No answer"}\NormalTok{)}
\FunctionTok{levels}\NormalTok{(hiv\_tab\_1\_data}\SpecialCharTok{$}\NormalTok{gonochlam)}\OtherTok{=}\FunctionTok{c}\NormalTok{(}\StringTok{"Positive"}\NormalTok{,}\StringTok{"Negative"}\NormalTok{, }\StringTok{"No answer"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\section{Kết quả: Bảng 1.}\label{kux1ebft-quux1ea3-bux1ea3ng-1.}

Để có bảng kết quả (Bảng 1) như trong bài báo đã công bố, chúng ta thực
hiện như sau:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Table 1. Baseline characteristics  {-}{-}{-}{-}}
\NormalTok{des\_table1 }\OtherTok{\textless{}{-}}\NormalTok{ hiv\_tab\_1\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{tbl\_summary}\NormalTok{(}
    \AttributeTok{include =} \FunctionTok{c}\NormalTok{(q103, age, age\_3cat, q105, q114, q107, duree, q205, q219,}
\NormalTok{                constante, q211, groupe, anal, hla9, gono, chlam, gonochlam,}
\NormalTok{                cd4\_nb, charge\_virale\_copies),}
    \AttributeTok{type =} \FunctionTok{list}\NormalTok{(}
      \FunctionTok{all\_continuous}\NormalTok{() }\SpecialCharTok{\textasciitilde{}} \StringTok{"continuous2"}
\NormalTok{    ),}
    \AttributeTok{statistic =} \FunctionTok{all\_continuous}\NormalTok{() }\SpecialCharTok{\textasciitilde{}} \FunctionTok{c}\NormalTok{(}\StringTok{"\{median\} (\{p25\}, \{p75\})"}\NormalTok{),}
    \AttributeTok{percent =} \StringTok{"column"}\NormalTok{,}
    \AttributeTok{label =} \FunctionTok{list}\NormalTok{(}
\NormalTok{      q103 }\SpecialCharTok{\textasciitilde{}} \StringTok{"Nationality"}\NormalTok{,}
\NormalTok{      age }\SpecialCharTok{\textasciitilde{}} \StringTok{"Age in years"}\NormalTok{,}
\NormalTok{      age\_3cat }\SpecialCharTok{\textasciitilde{}} \StringTok{"Age in years (categories)"}\NormalTok{,}
\NormalTok{      q105 }\SpecialCharTok{\textasciitilde{}} \StringTok{"Education"}\NormalTok{,}
\NormalTok{      q114 }\SpecialCharTok{\textasciitilde{}} \StringTok{"Marital status"}\NormalTok{,}
\NormalTok{      q107 }\SpecialCharTok{\textasciitilde{}} \StringTok{"Place of work"}\NormalTok{,}
\NormalTok{      duree }\SpecialCharTok{\textasciitilde{}} \StringTok{"Duration in sex work, months"}\NormalTok{,}
\NormalTok{      q205 }\SpecialCharTok{\textasciitilde{}} \StringTok{"Number of clients, last 7 days of work"}\NormalTok{,}
\NormalTok{      q219 }\SpecialCharTok{\textasciitilde{}} \StringTok{"Number of sexual intercourses, last 3 days"}\NormalTok{,}
\NormalTok{      constante }\SpecialCharTok{\textasciitilde{}} \StringTok{"Consistent condom use with clients (last 7 days of work)"}\NormalTok{,}
\NormalTok{      q211 }\SpecialCharTok{\textasciitilde{}} \StringTok{"Condom use with last client"}\NormalTok{,}
\NormalTok{      groupe }\SpecialCharTok{\textasciitilde{}} \StringTok{"HIV/treatment status"}\NormalTok{,}
\NormalTok{      anal }\SpecialCharTok{\textasciitilde{}} \StringTok{"Ever had anal sex (any partner)"}\NormalTok{,}
\NormalTok{      hla9 }\SpecialCharTok{\textasciitilde{}} \StringTok{"Ever had oral sex (any partner)"}\NormalTok{,}
\NormalTok{      gono }\SpecialCharTok{\textasciitilde{}} \StringTok{"NG prevalence"}\NormalTok{,}
\NormalTok{      chlam }\SpecialCharTok{\textasciitilde{}} \StringTok{"CT prevalence"}\NormalTok{,}
\NormalTok{      gonochlam }\SpecialCharTok{\textasciitilde{}} \StringTok{"NG/CT prevalence"}\NormalTok{,}
\NormalTok{      cd4\_nb }\SpecialCharTok{\textasciitilde{}} \StringTok{"CD4 cell count/mm³"}\NormalTok{,}
\NormalTok{      charge\_virale\_copies }\SpecialCharTok{\textasciitilde{}} \StringTok{"Viral load"}
\NormalTok{    ),}
    \AttributeTok{digits =} \FunctionTok{list}\NormalTok{(}
      \FunctionTok{all\_continuous}\NormalTok{() }\SpecialCharTok{\textasciitilde{}} \DecValTok{2}\NormalTok{,}
      \FunctionTok{all\_categorical}\NormalTok{() }\SpecialCharTok{\textasciitilde{}} \DecValTok{1}
\NormalTok{    ),}
    \AttributeTok{missing =} \StringTok{"no"}
\NormalTok{  ) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{modify\_header}\NormalTok{(}\AttributeTok{label =} \StringTok{"**Variable**"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}         \CommentTok{\# change label column header}
  \FunctionTok{modify\_caption}\NormalTok{(}\StringTok{"**Table 1. Baseline characteristics of 319 female sex workers,}
\StringTok{                 Cotonou, Benin, 2008–2012**"}\NormalTok{)   }\CommentTok{\# add table name/title}

\NormalTok{des\_table1 }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{as\_kable}\NormalTok{(}
    \AttributeTok{format =} \StringTok{"latex"}\NormalTok{,}
    \AttributeTok{longtable =} \ConstantTok{TRUE}\NormalTok{,}
    \AttributeTok{booktabs =} \ConstantTok{TRUE}
\NormalTok{  ) }\SpecialCharTok{\%\textgreater{}\%}
\NormalTok{  kableExtra}\SpecialCharTok{::}\FunctionTok{kable\_styling}\NormalTok{(}\AttributeTok{latex\_options =} \FunctionTok{c}\NormalTok{(}\StringTok{"repeat\_header"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[t]{lc}
\caption{\label{tab:unnamed-chunk-5}**Table 1. Baseline characteristics of 319 female sex workers,
Cotonou, Benin, 2008–2012**}\\
\toprule
**Variable** & **N = 319**\\
\midrule
\endfirsthead
\caption[]{**Table 1. Baseline characteristics of 319 female sex worke \textit{(continued)}}\\
\toprule
**Variable** & **N = 319**\\
\midrule
\endhead

\endfoot
\bottomrule
\endlastfoot
Nationality & \\
Benin & 123.0 (38.6\%)\\
Ghana & 49.0 (15.4\%)\\
Nigeria & 66.0 (20.7\%)\\
Togo & 74.0 (23.2\%)\\
\addlinespace
Others & 7.0 (2.2\%)\\
Age in years & \\
Median (Q1, Q3) & 34.00 (27.00, 41.00)\\
Age in years (categories) & \\
18 - 24 & 48.0 (15.0\%)\\
\addlinespace
25 - 34 & 112.0 (35.1\%)\\
>=35 & 159.0 (49.8\%)\\
Education & \\
Not educated & 107.0 (33.5\%)\\
Primary & 126.0 (39.5\%)\\
\addlinespace
Secondary & 79.0 (24.8\%)\\
Postsecondary, university & 7.0 (2.2\%)\\
Marital status & \\
Married & 21.0 (6.6\%)\\
Single & 102.0 (32.0\%)\\
\addlinespace
Divorced & 149.0 (46.7\%)\\
Widowed & 47.0 (14.7\%)\\
Place of work & \\
Brothel & 126.0 (39.6\%)\\
Home & 24.0 (7.5\%)\\
\addlinespace
Bars & 37.0 (11.6\%)\\
Hotels & 40.0 (12.6\%)\\
Street & 76.0 (23.9\%)\\
Nightclub & 6.0 (1.9\%)\\
Others & 9.0 (2.8\%)\\
\addlinespace
Duration in sex work, months & \\
Median (Q1, Q3) & 36.00 (16.00, 60.00)\\
Number of clients, last 7 days of work & \\
Median (Q1, Q3) & 13.00 (5.00, 26.00)\\
Number of sexual intercourses, last 3 days & \\
\addlinespace
Median (Q1, Q3) & 5.00 (1.00, 11.00)\\
Consistent condom use with clients (last 7 days of work) & 246.0 (77.1\%)\\
Condom use with last client & 279.0 (87.5\%)\\
HIV/treatment status & \\
HIV positive, treated & 49.0 (15.4\%)\\
\addlinespace
HIV positive, not treated & 82.0 (25.7\%)\\
HIV negative & 188.0 (58.9\%)\\
Ever had anal sex (any partner) & 16.0 (5.0\%)\\
Ever had oral sex (any partner) & 62.0 (19.4\%)\\
NG prevalence & \\
\addlinespace
Positive & 13.0 (4.1\%)\\
Negative & 301.0 (94.4\%)\\
No answer & 5.0 (1.6\%)\\
CT prevalence & \\
Positive & 9.0 (2.8\%)\\
\addlinespace
Negative & 305.0 (95.6\%)\\
No answer & 5.0 (1.6\%)\\
NG/CT prevalence & \\
Positive & 21.0 (6.6\%)\\
Negative & 293.0 (91.8\%)\\
\addlinespace
No answer & 5.0 (1.6\%)\\
CD4 cell count/mm³ & \\
Median (Q1, Q3) & 389.00 (214.50, 583.00)\\
Viral load & \\
Median (Q1, Q3) & 8,153.00 (154.00, 31,321.00)\\*
\end{longtable}

\begin{tcolorbox}[enhanced jigsaw, titlerule=0mm, breakable, opacitybacktitle=0.6, coltitle=black, colframe=quarto-callout-note-color-frame, left=2mm, colback=white, arc=.35mm, bottomtitle=1mm, opacityback=0, leftrule=.75mm, toprule=.15mm, bottomrule=.15mm, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{Bảng kết quả có thể xuất ra file word}, rightrule=.15mm, toptitle=1mm, colbacktitle=quarto-callout-note-color!10!white]

\section{des\_table1 \%\textgreater\%}\label{des_table1}

\section{as\_flex\_table() \%\textgreater\%}\label{as_flex_table}

\section{save\_as\_docx(path = ``Table 1. Baseline
characteristics.docx'')}\label{save_as_docxpath-table-1.-baseline-characteristics.docx}

\end{tcolorbox}




\end{document}
